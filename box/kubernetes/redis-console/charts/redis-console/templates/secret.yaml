{{- if and .Values.config.create (not .Values.config.existingSecretName) .Values.config.clusters }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "redis-console.fullname" . }}-config
  labels:
    {{- include "redis-console.labels" . | nindent 4 }}
type: Opaque
stringData:
  config.yaml: |
    clusters:
      {{- range .Values.config.clusters }}
      - alias: {{ .alias | quote }}
        host: {{ .host | quote }}
        port: {{ .port | default 6379 }}
        {{- if .password }}
        password: {{ .password | quote }}
        {{- end }}
        tls: {{ .tls | default false }}
        cluster_mode: {{ .clusterMode | default false }}
        {{- if .description }}
        description: {{ .description | quote }}
        {{- end }}
      {{- end }}
    {{- if .Values.config.awsRegion }}
    aws_region: {{ .Values.config.awsRegion | quote }}
    {{- end }}
{{- end }}
